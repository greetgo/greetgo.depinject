### Ссылки

 - [Очень быстрый старт (через TestNG)](fast_start.md)
 - [Быстрый старт (main-функция или war-файл)](quick_start.md)
 - [Концепция]
 - [Спецификация](spec.md)

### Концепция

Создаём бины с помощью аннотации `@Bean`. Но бины используются только те, которые подключены. Подключаем бины
с помощью `@BeanConfig`, не забывая использовать `@BeanScanner`. Далее создаём `BeanContainer`, и, с помощью
аннотации `@Include`, подключаем к нему созданные нами `@BeanConfig`-и. Далее из BeanContainer-а вытаскиваем
нужные нам бины и используем их.

### Бины

Бин-классы - это классы, инстанции которых могут быть бинами. Т.е. бин - это инстанция бин-класса.

Инстанции бин-классов создаются в бин-контэйнере по мере необходимости. 

Чтобы класс сделать бин-классом, его необходимо пометить аннотацией `@Bean`. Также у бин-класса должен быть публичный
контсруктор по умолчанию, иначе система не сможет создавать инстанции этого класса. Существует ещё [два способа создания
бинов](#bean-creation-variants) (- см. ниже).

Аннотации `@Bean` не достаточно, чтобы можно было создавать бин. Бин-класс необходимо ещё подключить к бин-контэйнеру.

> Подключение бин-классов к бин-контэйнерам происходит с помощью бин-конфигов

Бин-конфиг - это класс без методов и полей, ни что не наследующий и ни чего не расширяющий. Бин конфиг должен содержать
аннотацию `@BeanConfig`. Бин-конфиг должен содержать аннотации: `@BeanScanner` и/или `@Include`. 

Аннотация `@BeanScanner` обозначает, что данный бин-конфиг подключает все бин-классы, которые находятся в пакете данного
бин-конфига, а также во всей иерархии подпакетов этого пакета. (Этот конфиг как бы сканирует свой пакет и все
внутренние пакеты на наличие бинов).

Аннотация `@Include` подключает к данному бин-конфигу другие бин-конфиги, которые указанны в этой аннотации.

С помощью аннотаций `@BeanConfig`, `@BeanScanner` и `@Include` можно создавать разветвлённую сеть бинов, в нутри
проекта. Можно создать несколько бин-контэйнеров, и каждый бин-контэйнер содержит свой набор бинов. Какие-то бины
подключены к одному бин-контэйнеру, а какие-то к другом, а какие-то бины могут быть подключены
к нескольким бин-контэйнерам.

Таким простым способом можно настроить очень гибкую систему распределения бинов в проекте.
Какие-то бины могут быть только в продукте, какие-то только среди тестов, какие-то и там и там (например те, которых
надо тестировать).

### Точечное соединения бинов

Подключение одного бина к другому происходит с помощью интерфейса `BeanGetter`, например:

```
  public BeanGetter<SomeClass> someBean;
```

Сюда подключается бин, который должен быть `instanceOf SomeClass`. Такой бин должен найтись ровно один. Если их
найдётся больше или вообще ни одного не найдётся, то происходит ошибка сборки.

> Разработчик специально сделал так, чтобы в этом случае происходила ошибка. Чтобы небыло проблем с возвращением
  `null`, с непонятностью: а какой бин подключиться. А так всё понятно: ошибка! Конфигурируй так, чтобы был только
  один бин. И это на практике очень удобно.

### Множественное соединения бинов

Можно к одному бину за раз подключить сразу несколько бинов. Делается это с использованием `java.util.List`, например:

```
  public BeanGetter<List<SomeClass>> beans;
```

Сюда подключаются все бины, которые `instanceOf SomeClass`. Если таких бинов нет, то присвоится пустой массив.
Последовательность, в которой будут лежать бины внутри списка, **НЕ** определена, и возможности её задать нет.

### Синглтоны

Бин-классы могут быть синглтонами, а могут и не быть синглтонами. Если бин не
должен быть синглтоном, то его надо пометить так: `@Bean(singleton = false)`.

По умолчанию бин-класс - синглтон.

Синглтоны создаются потокобезопасно.

Следует понимать, что синглтон в depinject-е содержит одну инстанцию в рамках инстанции бин-контэйнера. Если создать
ещё одну инстанцию бин-контэйнера, то в ней будут создаваться новые инстанции бинов-синглтонов.

### Бин конфиги



### Бин-контэйнер

Бин-контэйнер представляет из себя интерфейс, который должен расширять интерфейс `BeanContainer`. В интерфейсе
`BeanContainer` нет ни каких методов - он служит лишь как индикатор. Самже интерфейс бин-контэйнера должен содержать
методы без параметров. Имена методов значения не имеют. Имеют значения тип возвращаемого значения.

> Тип возвращаемого значения бин-контэйнера должен однозначно определать какой-то один конкретный бин.

Бины к бин-контэйнеру необходимо подключать с помощью аннотации `@Include`.

Бин-контэйнер реализуется автоматически с помощью кодогенерации. Есть метод `DepinjectUtil.implementBeanContainers`
из библиотеки `greetgo.depinject.gen`, который сканирует указанный пакет на наличие интерфейсов бин-контэйнера
и создаёт для каждого найденного интерфейса его реализацию. Потом, эту реализацию, можно инстанцировать
с помощью метода `Depinject.newInstance`.

###### Bean creation variants
### Способы создания бинов